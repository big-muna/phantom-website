<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phantom Wallet | Crypto Dashboard</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
<style>
  /* ---------------- Reset ---------------- */
  * { margin:0; padding:0; box-sizing:border-box; font-family:"Segoe UI", sans-serif; }
  body {
    background: linear-gradient(-45deg,#0a0a1a,#1a0a2e,#16213e,#0a0a1a);
    background-size: 400% 400%;
    animation: gradientShift 20s ease infinite;
    color:#f1f5f9;
    min-height:100vh;
    overflow-x:hidden;
  }
  @keyframes gradientShift { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }

  /* ---------------- Header ---------------- */
  header {
    display:flex; justify-content:space-between; align-items:center;
    padding:20px 40px; background:rgba(0,0,0,0.5); backdrop-filter:blur(15px);
    border-bottom:1px solid rgba(96,165,250,.2); position:sticky; top:0; z-index:1000;
  }
  header h1 {
    font-size:24px; font-weight:700;
    background:linear-gradient(45deg,#60a5fa,#a78bfa);
    -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    display:flex; align-items:center; gap:10px;
  }
  header nav a {
    color:#93c5fd; margin-left:20px; text-decoration:none; font-weight:500;
    padding:8px 16px; border-radius:10px; transition:.3s;
  }
  header nav a:hover { color:#fff; background:rgba(96,165,250,0.15); }

  /* ---------------- Container ---------------- */
  .container { max-width:1200px; margin:40px auto; display:flex; flex-direction:column; gap:40px; padding:0 20px; }

  /* ---------------- Wallet Grid ---------------- */
  .wallet-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:25px; }
  .wallet-card {
    position:relative; border-radius:20px; padding:25px;
    background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,.1);
    backdrop-filter:blur(15px); transition:.4s; overflow:hidden;
  }
  .wallet-card::before {
    content:""; position:absolute; top:-50%; left:-50%; width:200%; height:200%;
    background:radial-gradient(circle,rgba(96,165,250,0.2),transparent 70%);
    animation: rotateBg 10s linear infinite; z-index:0;
  }
  @keyframes rotateBg { 0%{transform:rotate(0deg)} 100%{transform:rotate(360deg)} }
  .wallet-info { display:flex; align-items:center; gap:15px; margin-bottom:15px; position:relative; z-index:1; }
  .wallet-info i { font-size:32px; }
  .wallet-info h3 { font-size:18px; }
  .wallet-address { font-size:12px; background:rgba(255,255,255,.1); padding:6px 10px; border-radius:8px; word-break:break-all; margin-bottom:8px; color:#d1d5db; }
  .wallet-actions { display:flex; gap:10px; position:relative; z-index:1; }
  .wallet-actions button {
    flex:1; padding:10px; border:none; border-radius:12px; font-weight:600; cursor:pointer;
    color:#fff; background:linear-gradient(135deg,#2563eb,#1d4ed8); transition:.3s;
  }
  .wallet-actions button:hover { background:linear-gradient(135deg,#1d4ed8,#1e40af); transform:scale(1.05); }

  /* ---------------- Swap Card ---------------- */
  .swap-card {
    background:rgba(255,255,255,.05); border-radius:20px; padding:25px; backdrop-filter:blur(15px);
    display:flex; flex-direction:column; gap:12px; border:1px solid rgba(255,255,255,.1);
  }
  .swap-card h3 { margin-bottom:10px; }
  .swap-card select, .swap-card input {
    padding:12px; border-radius:12px; border:none; background:rgba(255,255,255,.1); color:#fff; margin-bottom:8px;
  }
  .swap-card button { padding:12px; border:none; border-radius:12px; background:linear-gradient(135deg,#10b981,#059669); color:#fff; font-weight:600; cursor:pointer; transition:.3s; }
  .swap-card button:hover { background:linear-gradient(135deg,#059669,#047857); transform:scale(1.03); }

  /* ---------------- Charts ---------------- */
  .chart-container {
    background:rgba(255,255,255,.05); border-radius:20px; padding:25px; border:1px solid rgba(255,255,255,.1); backdrop-filter:blur(15px);
  }
  canvas { width:100%!important; height:380px!important; }
  @media(max-width:768px){canvas{height:260px!important}}
  @media(max-width:480px){canvas{height:200px!important}}

  /* ---------------- Notifications ---------------- */
  #notification {
    position:fixed; top:-100px; right:30px; background:linear-gradient(135deg,#10b981,#059669);
    color:#fff; padding:15px 20px; border-radius:12px; font-weight:600; transition:.5s; z-index:10000;
  }
  #notification.show { top:30px; }

  /* ---------------- Modals ---------------- */
  .modal { position:fixed; top:0; left:0; width:100%; height:100%; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,.7); z-index:2000; }
  .modal-content {
    background:#1e293b; padding:25px; border-radius:15px; width:400px; max-width:90%;
    color:#fff; display:flex; flex-direction:column; gap:15px;
  }
  .modal-content input, .modal-content select {
    width:100%; padding:10px; margin:8px 0; border:none; border-radius:8px; background:#334155; color:#fff;
  }
  .modal-content button { padding:12px; width:100%; border:none; border-radius:8px; background:linear-gradient(135deg,#2563eb,#1d4ed8); color:#fff; font-weight:600; cursor:pointer; }
  .modal-content button:hover { transform:scale(1.03); }
</style>
</head>
<body>

<header>
  <h1><i class="fas fa-shield-alt"></i> Phantom Wallet</h1>
  <nav>
    <a href="#"><i class="fas fa-chart-line"></i> Dashboard</a>
    <a href="#"><i class="fas fa-download"></i> Withdraw</a>
    <a href="#"><i class="fas fa-user"></i> Profile</a>
    <a href="#"><i class="fas fa-sign-out-alt"></i> Logout</a>
  </nav>
</header>

<div class="container">

  <!-- Wallets -->
  <div class="wallet-grid">
    {% for wallet in wallets %}
    <div class="wallet-card" data-coin="{{ wallet.coin }}">
      <div class="wallet-info">
        {% if wallet.coin=='BTC' %}
          <i class="fab fa-bitcoin" style="color:#f7931a"></i>
        {% elif wallet.coin=='ETH' %}
          <i class="fab fa-ethereum" style="color:#627eea"></i>
        {% else %}
          <i class="fas fa-dollar-sign" style="color:#22c55e"></i>
        {% endif %}
        <div>
          <h3>{{ wallet.coin }}</h3>
          <p class="wallet-address" id="address{{ wallet.coin }}"></p>
          <p>Balance: <span class="balance-amount" data-value="{{ wallet.balance }}">{{ wallet.balance }}</span> {{ wallet.coin }}</p>
        </div>
      </div>
      <div class="wallet-actions">
        <button onclick="openWithdraw('{{ wallet.coin }}')">Withdraw</button>
        <button onclick="receiveCrypto('{{ wallet.coin }}')">Receive</button>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Swap Card -->
  <div class="swap-card">
    <h3>Instant Swap</h3>
    <select id="fromCrypto">{% for wallet in wallets %}<option>{{ wallet.coin }}</option>{% endfor %}</select>
    <input type="number" id="fromAmount" placeholder="Enter amount">
    <select id="toCrypto">{% for wallet in wallets %}<option>{{ wallet.coin }}</option>{% endfor %}</select>
    <input type="number" id="toAmount" placeholder="You receive" readonly>
    <button onclick="swapCrypto()">Swap Now</button>
  </div>

  <!-- Charts -->
  <div class="chart-container">
    <h3>Portfolio Distribution</h3>
    <canvas id="balanceChart"></canvas>
  </div>
  <div class="chart-container">
    <h3>Live Market Trend</h3>
    <canvas id="marketChart"></canvas>
  </div>

</div>

<!-- Withdraw Modal -->
<div class="modal" id="withdrawModal">
  <div class="modal-content">
    <h2>Withdraw <span id="withdrawCoin"></span></h2>
    <label>Choose Method</label>
    <select id="withdrawMethod" onchange="toggleWithdrawFields()">
      <option value="wallet">Crypto Wallet</option>
      <option value="bank">Bank Account</option>
    </select>
    <div id="walletFields">
      <input type="text" id="withdrawAddress" placeholder="Wallet Address">
    </div>
    <div id="bankFields" style="display:none;">
      <select id="bankCountry">
        <option value="">Select Country</option>
        <option value="us">United States</option>
        <option value="uk">United Kingdom</option>
        <option value="ca">Canada</option>
        <option value="ng">Nigeria</option>
        <option value="in">India</option>
      </select>
      <input type="text" id="bankName" placeholder="Bank Name">
      <input type="text" id="accountNumber" placeholder="Account Number">
      <input type="text" id="accountHolder" placeholder="Account Holder Name">
      <input type="text" id="swiftCode" placeholder="SWIFT / Routing Code">
    </div>
    <input type="number" id="withdrawAmount" placeholder="Amount">
    <button onclick="confirmWithdraw()">Confirm Withdraw</button>
  </div>
</div>

<!-- Receive Modal -->
<div class="modal" id="receiveModal">
  <div class="modal-content">
    <h2>Receive <span id="receiveCoin"></span></h2>
    <p>Your Wallet Address:</p>
    <input type="text" id="receiveAddress" readonly>
    <input type="number" id="receiveAmount" placeholder="Enter amount to add">
    <button onclick="confirmReceive()">Add to Wallet</button>
  </div>
</div>

<div id="notification">✔️ Action Successful!</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // ---------------- Generate Wallet Addresses ----------------
  function generateAddress(coin){
    let chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
    let addr="";
    for(let i=0;i<34;i++) addr+=chars.charAt(Math.floor(Math.random()*chars.length));
    document.getElementById("address"+coin).textContent=addr;
  }
  {% for wallet in wallets %} generateAddress("{{ wallet.coin }}"); {% endfor %}

  // ---------------- Animate Balances ----------------
  function animateBalance(el,target){
    let c=parseFloat(el.textContent);
    const step=(target-c)/60;
    const i=setInterval(()=>{
      c+=step;
      if((step>0 && c>=target) || (step<0 && c<=target)){c=target;clearInterval(i);}
      el.textContent=c.toFixed(3);
    },16);
  }
  window.onload=()=>{
    document.querySelectorAll('.balance-amount').forEach(el=>animateBalance(el,parseFloat(el.dataset.value)));
  };

  // ---------------- Notifications ----------------
  function showNotif(msg){
    const n=document.getElementById('notification');
    n.textContent=msg; n.classList.add('show');
    setTimeout(()=>n.classList.remove('show'),3000);
  }

  // ---------------- Swap ----------------
  function swapCrypto(){
    let from=document.getElementById('fromAmount').value;
    document.getElementById('toAmount').value=from; // dummy 1:1 rate
    showNotif("✔️ Swap Successful!");
  }

  // ---------------- Withdraw ----------------
  let selectedCoin="";
  function openWithdraw(coin){
    selectedCoin=coin;
    document.getElementById('withdrawCoin').textContent=coin;
    document.getElementById('withdrawModal').style.display='flex';
  }
  function toggleWithdrawFields() {
    const method=document.getElementById("withdrawMethod").value;
    document.getElementById("walletFields").style.display = method==="wallet"?"block":"none";
    document.getElementById("bankFields").style.display = method==="bank"?"block":"none";
  }
  function confirmWithdraw(){
    let method=document.getElementById('withdrawMethod').value;
    let amt=parseFloat(document.getElementById('withdrawAmount').value);
    if(!amt){showNotif("❌ Enter withdrawal amount!");return;}
    let details="";
    if(method==="wallet"){
      let addr=document.getElementById('withdrawAddress').value;
      if(addr===""){showNotif("❌ Enter wallet address!");return;}
      details=`Wallet: ${addr}`;
    } else {
      let country=document.getElementById('bankCountry').value;
      let bank=document.getElementById('bankName').value;
      let acc=document.getElementById('accountNumber').value;
      let holder=document.getElementById('accountHolder').value;
      let swift=document.getElementById('swiftCode').value;
      if(!country||!bank||!acc||!holder||!swift){showNotif("❌ Fill all bank details!");return;}
      details=`Bank: ${bank}, Account: ${acc}, Holder: ${holder}, SWIFT: ${swift}`;
    }
    let fee=amt*0.1;
    let finalAmt=amt-fee;
    const walletEl=document.querySelector(`.wallet-card[data-coin="${selectedCoin}"] .balance-amount`);
    let current=parseFloat(walletEl.textContent);
    let newBalance=current-finalAmt;
    walletEl.textContent=newBalance.toFixed(3);
    walletEl.dataset.value=newBalance.toFixed(3);
    document.getElementById('withdrawModal').style.display='none';
    showNotif(`✔️ ${finalAmt} ${selectedCoin} sent via ${method.toUpperCase()} (${details}) (10% fee: ${fee} ${selectedCoin})`);
  }

  // ---------------- Receive ----------------
  function receiveCrypto(coin){
    selectedCoin=coin;
    document.getElementById('receiveCoin').textContent=coin;
    document.getElementById('receiveAmount').value='';
    document.getElementById('receiveAddress').value=document.getElementById("address"+coin).textContent;
    document.getElementById('receiveModal').style.display='flex';
  }
  function confirmReceive(){
    let amt=parseFloat(document.getElementById('receiveAmount').value);
    if(!amt){showNotif("❌ Enter amount!");return;}
    const walletEl=document.querySelector(`.wallet-card[data-coin="${selectedCoin}"] .balance-amount`);
    let current=parseFloat(walletEl.textContent);
    let newBalance=current+amt;
    walletEl.textContent=newBalance.toFixed(3);
    walletEl.dataset.value=newBalance.toFixed(3);
    document.getElementById('receiveModal').style.display='none';
    showNotif(`✔️ ${amt} ${selectedCoin} received!`);
  }

  // ---------------- Close Modals ----------------
  window.onclick=function(e){
    if(e.target==document.getElementById('withdrawModal')) document.getElementById('withdrawModal').style.display='none';
    if(e.target==document.getElementById('receiveModal')) document.getElementById('receiveModal').style.display='none';
  }

  // ---------------- Charts ----------------
  const portfolioData = {{ portfolio | tojson }};
  new Chart(document.getElementById('balanceChart'), {
    type:'doughnut',
    data:{labels:portfolioData.map(w=>w.coin),datasets:[{data:portfolioData.map(w=>w.balance),backgroundColor:['#f7931a','#627eea','#22c55e']}]},
    options:{plugins:{legend:{labels:{color:'#fff'}}}}
  });

  const marketData = {{ market_trends | tojson }};
  new Chart(document.getElementById('marketChart'), {
    type:'line',
    data:{
      labels:marketData.map((_,i)=>`T${i+1}`),
      datasets:[
        {label:'BTC',data:marketData.map(d=>d.coin=='BTC'?d.price:0),borderColor:'#f7931a',fill:true,tension:0.4},
        {label:'ETH',data:marketData.map(d=>d.coin=='ETH'?d.price:0),borderColor:'#627eea',fill:true,tension:0.4},
        {label:'USDT',data:marketData.map(d=>d.coin=='USDT'?d.price:0),borderColor:'#22c55e',fill:true,tension:0.4}
      ]
    },
    options:{plugins:{legend:{labels:{color:'#fff'}}}, scales:{x:{ticks:{color:'#fff'}},y:{ticks:{color:'#fff'}}}}
  });
</script>
</body>
</html>
